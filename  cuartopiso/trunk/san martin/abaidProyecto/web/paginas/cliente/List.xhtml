<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui">



    <ui:composition template="/template.xhtml">
        <ui:define name="title">
            <h:outputText value="#{bundle.ListClienteTitle}"></h:outputText>
        </ui:define>
        <ui:define name="body">

            <f:view contentType="text/html">
                <h:head>
                    <f:facet name="first">
                        <meta content='text/html; charset=UTF-8' http-equiv="Content-Type"/>
                        <title>PrimeFaces</title>
                    </f:facet>
                </h:head>
                <h:form styleClass="jsfcrud_list_form" id="ListaClientes">
                    <p:layout fullPage="true">

                        <p:layoutUnit position="north" size="100" resizable="true" closable="true" collapsible="true">
                            Header
                        </p:layoutUnit>

                        <p:layoutUnit position="south" size="50" closable="true" collapsible="true">
                            <p:commandButton value="Cerra Sesion" action="#{usuarioController.logout}" />
                        </p:layoutUnit>

                        <p:layoutUnit position="west" size="130" header="Opciones " collapsible="true" >

                            <h:link outcome="/paginas/cliente/List" value="Clientes" style="color:  #00ffcc"/>

                            <br />
                            <h:link outcome="/paginas/credito/List" value="Creditos" style="color: #00ffcc"/>


                        </p:layoutUnit>

                        <p:layoutUnit position="center" id="layoutUnitCentro">
                            <center>
                                <h1>Lista de Clientes</h1>
                                <h3>Buscar clientes por dni</h3>
                                <h:panelGroup id="messagePanel" layout="block">
                                    <h:messages errorStyle="color: red" infoStyle="color: green" layout="table"/>
                                </h:panelGroup>
                                <h:outputText escape="false" value="#{bundle.ListClienteEmpty}" rendered="#{clienteController.items.rowCount == 0}"/>
                                <h:panelGroup rendered="#{clienteController.items.rowCount > 0}">
                                    <h:outputText value="#{clienteController.pagination.pageFirstItem + 1}..#{clienteController.pagination.pageLastItem + 1}/#{clienteController.pagination.itemsCount}"/>&nbsp;
                                    <h:commandLink action="#{clienteController.previous}" value="#{bundle.Previous} #{clienteController.pagination.pageSize}" rendered="#{clienteController.pagination.hasPreviousPage}"/>&nbsp;
                                    <h:commandLink action="#{clienteController.next}" value="#{bundle.Next} #{clienteController.pagination.pageSize}" rendered="#{clienteController.pagination.hasNextPage}"/>&nbsp;
                                    <p:dataTable value="#{clienteController.items}" var="item" selectionMode="single"
                                                 style=" width: 600px" filteredValue="#{clienteController.filtroCliente}" 
                                                 styleClass="jsfcrud_odd_row,jsfcrud_even_row" selection="#{clienteController.current}"
                                                 rowKey="#{item.idCliente}">

                                        <p:ajax event="rowSelect" update=":ListaClientes:display" 
                                                oncomplete="actualClienteDialog.show()"/> 

                                        <p:column filterBy="#{item.dni}">
                                            <f:facet name="header">
                                                <h:outputText value="Dni"/>
                                            </f:facet>
                                            <h:outputText value="#{item.dni}"/>
                                        </p:column>
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputText value="#{bundle.ListClienteTitle_nombre}"/>
                                            </f:facet>
                                            <h:outputText value="#{item.nombre}"/>
                                        </p:column>
                                        <p:column >
                                            <f:facet name="header">
                                                <h:outputText value="#{bundle.ListClienteTitle_apellido}"/>
                                            </f:facet>
                                            <h:outputText value="#{item.apellido}"/>
                                        </p:column>
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputText value="#{bundle.ListClienteTitle_mail}"/>
                                            </f:facet>
                                            <h:outputText value="#{item.mail}"/>
                                        </p:column>
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputText value="#{bundle.ListClienteTitle_telefono1}"/>
                                            </f:facet>
                                            <h:outputText value="#{item.telefono1}"/>
                                        </p:column>
                                        <p:column>
                                            <f:facet name="header">
                                                <h:outputText value="&nbsp;"/>
                                            </f:facet>
                                            <h:commandLink action="#{clienteController.prepareView}" value="#{bundle.ListClienteViewLink}" />
                                            <h:outputText value=" "/>
                                            <h:commandLink action="#{clienteController.prepareEdit}" value="#{bundle.ListClienteEditLink}" />

                                        </p:column>
                                    </p:dataTable>
                                    <p:dialog id="dialog1" header="Detalle Cliente" widgetVar="actualClienteDialog" resizable="true"  
                                              width="600" showEffect="scale" hideEffect="slide" style="background-color: tan; font-size: 15px">
                                        <p:dataTable id="display" value="#{clienteController.selected.creditoList}" var="item" style=" width: 500px"
                                                     >
                                            <p:column>
                                                <f:facet name="header">
                                                    <h:outputText value="Fecha"/>
                                                </f:facet>
                                                <h:outputText value="#{item.fechaVto1}">
                                                    <f:convertDateTime pattern="MM/dd/yyyy" />
                                                </h:outputText>
                                            </p:column>
                                            <p:column>
                                                <f:facet name="header">
                                                    <h:outputText value="#{bundle.ListCreditoTitle_cuota}"/>
                                                </f:facet>
                                                <h:outputText value="#{item.cuota}"/>
                                            </p:column>
                                            <p:column>
                                                <f:facet name="header">
                                                    <h:outputText value="#{bundle.ListCreditoTitle_montoXcuota}"/>
                                                </f:facet>
                                                <h:outputText value="#{item.montoXcuota}"/>
                                            </p:column>
                                            <p:column>
                                                <f:facet name="header">
                                                    <h:outputText value="#{bundle.ListCreditoTitle_intXcuota}"/>
                                                </f:facet>
                                                <h:outputText value="#{item.intXcuota}"/>
                                            </p:column>
                                            <p:column>
                                                <f:facet name="header">
                                                    <h:outputText value="#{bundle.ListCreditoTitle_montoTotal}"/>
                                                </f:facet>
                                                <h:outputText value="#{item.montoTotal}"/>
                                            </p:column>          
                                            <p:column>
                                                <f:facet name="header">
                                                    <h:outputText value="Cancelado"/>
                                                </f:facet>
                                                <h:outputText value="#{item.cancelado}"/>
                                            </p:column>
                                        </p:dataTable>   
                                    </p:dialog>       
                                </h:panelGroup>
                                <br />
                                <h:commandLink action="#{clienteController.prepareCreate}" value="#{bundle.ListClienteCreateLink}"/>
                                &nbsp;
                                <h:link outcome="/paginas/credito/Create.xhtml" value="Ortorgar un nuevo credito" />
                                &nbsp;
                                &nbsp;
                                <h:link outcome="/principal.xhtml" value="#{bundle.ListClienteIndexLink}"/>


                            </center>
                        </p:layoutUnit>

                    </p:layout>
                </h:form>
            </f:view>
        </ui:define>
    </ui:composition>





</html>
